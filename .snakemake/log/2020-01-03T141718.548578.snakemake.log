Building DAG of jobs...
Creating conda environment /home/users/aheintzbuschart/dadasnake/dada_scripts/dada_env.yml...
Downloading remote packages.
Environment for ../../../../../../home/users/aheintzbuschart/dadasnake/dada_scripts/dada_env.yml created (location: ../../../../../../home/users/aheintzbuschart/dadasnake/dada_env_common/4c81f485)
Using shell: /usr/bin/bash
Provided cores: 1
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	ALL
	1	SamplesPrint
	1	biom_handoff_preTax
	4	combine_or_rename
	4	cut_primers_both
	1	dada_control
	4	dada_errors
	3	dada_filter
	3	dada_mergeReadPairs
	2	dada_mergeSamples
	1	dada_mergeruns
	2	dada_qc1
	2	dada_qc_filtered
	1	filter_numbers
	1	input_numbers
	1	merged_numbers
	1	nochime_numbers
	1	primer_numbers
	1	primers_control
	35

[Fri Jan  3 14:22:57 2020]
Job 18: Running cutadapt on ../testdata/OTU_Nh_II_15_tail_R1_001.fastq ../testdata/OTU_Nh_II_15_tail_R2_001.fastq. Searching for both  primers in both reads.

Activating conda environment: /home/users/aheintzbuschart/dadasnake/dada_env_common/4c81f485
[Fri Jan  3 14:23:00 2020]
Finished job 18.
1 of 35 steps (3%) done

[Fri Jan  3 14:23:00 2020]
Job 17: Running cutadapt on ../testdata/OTU_Nh_II_15_head_R1_001.fastq ../testdata/OTU_Nh_II_15_head_R2_001.fastq. Searching for both  primers in both reads.

Activating conda environment: /home/users/aheintzbuschart/dadasnake/dada_env_common/4c81f485
[Fri Jan  3 14:23:02 2020]
Finished job 17.
2 of 35 steps (6%) done

[Fri Jan  3 14:23:02 2020]
Job 19: Running cutadapt on ../testdata/OTU_Nh_III_15_head_R1_001.fastq ../testdata/OTU_Nh_III_15_head_R2_001.fastq. Searching for both  primers in both reads.

Activating conda environment: /home/users/aheintzbuschart/dadasnake/dada_env_common/4c81f485
[Fri Jan  3 14:23:05 2020]
Finished job 19.
3 of 35 steps (9%) done

[Fri Jan  3 14:23:05 2020]
Job 6: Running cutadapt on ../testdata/OTU_NhP_II_15_head_R1_001.fastq ../testdata/OTU_NhP_II_15_head_R2_001.fastq. Searching for both  primers in both reads.

Activating conda environment: /home/users/aheintzbuschart/dadasnake/dada_env_common/4c81f485
[Fri Jan  3 14:23:07 2020]
Finished job 6.
4 of 35 steps (11%) done

[Fri Jan  3 14:23:07 2020]
Job 25: Running filtering on preprocessing/A/OTU_NhP_II.fwd.fastq preprocessing/A/OTU_NhP_II.rvs.fastq.

Activating conda environment: /home/users/aheintzbuschart/dadasnake/dada_env_common/4c81f485
[Fri Jan  3 14:23:23 2020]
Finished job 25.
5 of 35 steps (14%) done

[Fri Jan  3 14:23:23 2020]
rule SamplesPrint:
    input: ../testdata/samples.small.tsv
    output: reporting/sample_table.tsv
    jobid: 20

[Fri Jan  3 14:23:30 2020]
Finished job 20.
6 of 35 steps (17%) done

[Fri Jan  3 14:23:30 2020]
rule input_numbers:
    input: reporting/sample_table.tsv, ../testdata/OTU_Nh_II_15_head_R1_001.fastq, ../testdata/OTU_NhP_II_15_head_R1_001.fastq, ../testdata/OTU_Nh_II_15_tail_R1_001.fastq, ../testdata/OTU_Nh_III_15_head_R1_001.fastq, ../testdata/OTU_Nh_II_15_head_R2_001.fastq, ../testdata/OTU_NhP_II_15_head_R2_001.fastq, ../testdata/OTU_Nh_II_15_tail_R2_001.fastq, ../testdata/OTU_Nh_III_15_head_R2_001.fastq
    output: reporting/readNumbers.tsv
    log: logs/countInputReads.log
    jobid: 9

Activating conda environment: /home/users/aheintzbuschart/dadasnake/dada_env_common/4c81f485
[Fri Jan  3 14:23:31 2020]
Finished job 9.
7 of 35 steps (20%) done

[Fri Jan  3 14:23:31 2020]
rule primer_numbers:
    input: reporting/readNumbers.tsv, preprocessing/A/OTU_Nh_IIa.fwd.fastq, preprocessing/A/OTU_Nh_IIa.rvs.fastq, preprocessing/A/OTU_NhP_II.fwd.fastq, preprocessing/A/OTU_NhP_II.rvs.fastq, preprocessing/A/OTU_Nh_IIb.fwd.fastq, preprocessing/A/OTU_Nh_IIb.rvs.fastq, preprocessing/B/OTU_Nh_III.fwd.fastq, preprocessing/B/OTU_Nh_III.rvs.fastq
    output: reporting/primerNumbers_perLibrary.tsv, reporting/primerNumbers_perSample.tsv
    log: logs/countPrimerReads.log
    jobid: 10

Activating conda environment: /home/users/aheintzbuschart/dadasnake/dada_env_common/4c81f485
[Fri Jan  3 14:23:33 2020]
Finished job 10.
8 of 35 steps (23%) done

[Fri Jan  3 14:23:33 2020]
rule combine_or_rename:
    input: reporting/primerNumbers_perLibrary.tsv, preprocessing/A/OTU_Nh_IIa.rvs.fastq, preprocessing/A/OTU_Nh_IIb.rvs.fastq
    output: preprocessing/A/OTU_Nh_II.rvs.fastq
    log: logs/combine_or_rename.A.OTU_Nh_II.rvs.log
    jobid: 5
    wildcards: run=A, sample=OTU_Nh_II, direction=rvs

[Fri Jan  3 14:23:34 2020]
Finished job 5.
9 of 35 steps (26%) done

[Fri Jan  3 14:23:34 2020]
rule combine_or_rename:
    input: reporting/primerNumbers_perLibrary.tsv, preprocessing/A/OTU_Nh_IIa.fwd.fastq, preprocessing/A/OTU_Nh_IIb.fwd.fastq
    output: preprocessing/A/OTU_Nh_II.fwd.fastq
    log: logs/combine_or_rename.A.OTU_Nh_II.fwd.log
    jobid: 4
    wildcards: run=A, sample=OTU_Nh_II, direction=fwd

[Fri Jan  3 14:23:35 2020]
Finished job 4.
10 of 35 steps (29%) done

[Fri Jan  3 14:23:35 2020]
Job 13: Running QC on preprocessing/A.

Activating conda environment: /home/users/aheintzbuschart/dadasnake/dada_env_common/4c81f485
[Fri Jan  3 14:23:56 2020]
Finished job 13.
11 of 35 steps (31%) done

[Fri Jan  3 14:23:56 2020]
Job 24: Running filtering on preprocessing/A/OTU_Nh_II.fwd.fastq preprocessing/A/OTU_Nh_II.rvs.fastq.

Activating conda environment: /home/users/aheintzbuschart/dadasnake/dada_env_common/4c81f485
[Fri Jan  3 14:24:11 2020]
Finished job 24.
12 of 35 steps (34%) done

[Fri Jan  3 14:24:11 2020]
rule combine_or_rename:
    input: reporting/primerNumbers_perLibrary.tsv, preprocessing/B/OTU_Nh_III.rvs.fastq
    output: preprocessing/B/OTU_NhP_III.rvs.fastq
    log: logs/combine_or_rename.B.OTU_NhP_III.rvs.log
    jobid: 8
    wildcards: run=B, sample=OTU_NhP_III, direction=rvs

[Fri Jan  3 14:24:12 2020]
Finished job 8.
13 of 35 steps (37%) done

[Fri Jan  3 14:24:12 2020]
rule combine_or_rename:
    input: reporting/primerNumbers_perLibrary.tsv, preprocessing/B/OTU_Nh_III.fwd.fastq
    output: preprocessing/B/OTU_NhP_III.fwd.fastq
    log: logs/combine_or_rename.B.OTU_NhP_III.fwd.log
    jobid: 7
    wildcards: run=B, sample=OTU_NhP_III, direction=fwd

[Fri Jan  3 14:24:13 2020]
Finished job 7.
14 of 35 steps (40%) done

[Fri Jan  3 14:24:13 2020]
rule primers_control:
    input: preprocessing/A/OTU_Nh_II.fwd.fastq, preprocessing/A/OTU_Nh_II.rvs.fastq, preprocessing/A/OTU_NhP_II.fwd.fastq, preprocessing/A/OTU_NhP_II.rvs.fastq, preprocessing/A/OTU_Nh_II.fwd.fastq, preprocessing/A/OTU_Nh_II.rvs.fastq, preprocessing/B/OTU_NhP_III.fwd.fastq, preprocessing/B/OTU_NhP_III.rvs.fastq, reporting/readNumbers.tsv, reporting/primerNumbers_perSample.tsv
    output: primers.done
    jobid: 1

[Fri Jan  3 14:24:13 2020]
Finished job 1.
15 of 35 steps (43%) done

[Fri Jan  3 14:24:13 2020]
Job 14: Running QC on preprocessing/B.

Activating conda environment: /home/users/aheintzbuschart/dadasnake/dada_env_common/4c81f485
[Fri Jan  3 14:24:29 2020]
Finished job 14.
16 of 35 steps (46%) done

[Fri Jan  3 14:24:29 2020]
Job 26: Running filtering on preprocessing/B/OTU_NhP_III.fwd.fastq preprocessing/B/OTU_NhP_III.rvs.fastq.

Activating conda environment: /home/users/aheintzbuschart/dadasnake/dada_env_common/4c81f485
[Fri Jan  3 14:24:44 2020]
Finished job 26.
17 of 35 steps (49%) done

[Fri Jan  3 14:24:44 2020]
rule filter_numbers:
    input: reporting/primerNumbers_perLibrary.tsv, filtered/A/OTU_Nh_II.fwd.fastq.gz, filtered/A/OTU_Nh_II.rvs.fastq.gz, filtered/A/OTU_NhP_II.fwd.fastq.gz, filtered/A/OTU_NhP_II.rvs.fastq.gz, filtered/A/OTU_Nh_II.fwd.fastq.gz, filtered/A/OTU_Nh_II.rvs.fastq.gz, filtered/B/OTU_NhP_III.fwd.fastq.gz, filtered/B/OTU_NhP_III.rvs.fastq.gz
    output: reporting/filteredNumbers_perLibrary.tsv, reporting/filteredNumbers_perSample.tsv
    log: logs/countFilteredReads.log
    jobid: 30

Activating conda environment: /home/users/aheintzbuschart/dadasnake/dada_env_common/4c81f485
[Fri Jan  3 14:24:45 2020]
Finished job 30.
18 of 35 steps (51%) done

[Fri Jan  3 14:24:46 2020]
Job 15: Running QC on filtered/A.

Activating conda environment: /home/users/aheintzbuschart/dadasnake/dada_env_common/4c81f485
Terminating processes on user request, this might take some time.
[Fri Jan  3 14:24:46 2020]
Error in rule dada_qc_filtered:
    jobid: 15
    output: stats/QC_filtered.A.fwd.pdf, stats/QC_filtered.A.rvs.pdf
    log: logs/DADA2_QC_filtered.A.log
    conda-env: /home/users/aheintzbuschart/dadasnake/dada_env_common/4c81f485

RuleException:
CalledProcessError in line 89 of /home/users/aheintzbuschart/dadasnake/dada_scripts/dada.paired.rules:
Command 'source activate /home/users/aheintzbuschart/dadasnake/dada_env_common/4c81f485; set -euo pipefail;  Rscript --vanilla /mnt/irisgpfs/users/aheintzbuschart/dadasnake/testoutput/.snakemake/scripts/tmpv3t7eeo8.dada_QC.R ' died with <Signals.SIGINT: 2>.
  File "/home/users/aheintzbuschart/dadasnake/dada_scripts/dada.paired.rules", line 89, in __rule_dada_qc_filtered
  File "/home/users/aheintzbuschart/dadasnake/dada_env/lib/python3.6/concurrent/futures/thread.py", line 56, in run
Complete log: /mnt/irisgpfs/users/aheintzbuschart/dadasnake/.snakemake/log/2020-01-03T141718.548578.snakemake.log
